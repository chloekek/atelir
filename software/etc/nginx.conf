# We use either Hivemind or systemd.
# We do not want Nginx to daemonize itself.
daemon off;

# Configure these to be relative to the prefix path.
# The prefix path is passed by the Nix-generated wrapper.
error_log error.log;
pid nginx.pid;

events
{
}

http
{
    # Configure these to be relative to the prefix path.
    # The prefix path is passed by the Nix-generated wrapper.
    access_log            access.log;
    client_body_temp_path client_body_temp;
    fastcgi_temp_path     fastcgi_temp;
    proxy_temp_path       proxy_temp;
    scgi_temp_path        scgi_temp;
    uwsgi_temp_path       uwsgi_temp;

    types {
        text/css css;
    }

    server
    {
        listen {{ nginxPort }};

        # The functional routes are generated by build/routes.pl.
        # The remaining routes are for static files, and defined here.
        include {{ out }}/etc/routes.conf;

        # This is the target of all static file routes.
        location ~ \.css$
        {
            root {{ out }}/www;
        }
    }
}
